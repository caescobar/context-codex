# Builder Run — 2026-02-05T13:56:55

## Input original
Usar PackDir existente: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/
Fuente obligatoria: contexto/01_audits/2026-02-05__audit-02__unificacion-di-config-connectors-api-kiss-workers.md
Quiero generar el PROMPT FINAL para ejecutar PHASE-03 basada en la sección “Plan sugerido por fases”, Fase 3.  
Usa exactamente el objetivo/archivos/verificación definidos ahí, sin ampliar alcance.

Tarea:
1) Clasifica en: HALLAZGO | AUDIT | PHASE | STORY PACK (rationale en 2 bullets).
2) Determina el PackDir:
   - Si el input refiere a un pack existente, usar ese pack.
   - Si no, crear uno nuevo: contexto/00_prompts/YYYY-MM-DD__pack-{slug}/
3) Crea/actualiza el índice del pack:
   - contexto/00_prompts/YYYY-MM-DD__pack-{slug}/INDEX.md
   Reglas del índice:
   - Debe incluir checkboxes de estado del pack.
   - Debe incluir cada item con checkbox + links a Prompt y Output.
4) Guarda el prompt en:
   - contexto/00_prompts/YYYY-MM-DD__pack-{slug}/phases/phase-03__{slug}__PHASE__PROMPT.md 
5) (Si aplica) Actualiza en el INDEX el link de Output con ruta real esperada:
   - PHASE -> contexto/02_changes/YYYY-MM-DD__phase-03__{slug}__{plan|summary}.md 

Guardrails:
- Solo escribir en contexto/
- No tocar código
- No pedir confirmación: escribir los archivos en contexto/ directamente.
- No incluir report-only como skill si el prompt debe escribir en contexto/.
- PHASE: max 5 archivos de código.
- Prohibido cambiar contratos externos (Redis key patterns, Rabbit routing keys, SignalR group naming) sin migración explícita.

Salida obligatoria:
- CLASIFICACIÓN
- PROMPT FINAL (listo para copiar/pegar)
- ARCHIVO (PackDir + archivo prompt creado)
- INDEX actualizado

## Clasificacion
PHASE

## Rationale
- El pedido es un cambio acotado y ya decidido (fase 3), con objetivo y archivos especificos.
- El alcance esta limitado a 3 archivos de Options, dentro del maximo de 5.

## PROMPT FINAL
# PHASE PROMPT — phase-03__consolidar-esquema-options

PackDir: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global
ItemId: PHASE-03
IndexRef: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/INDEX.md
PromptPath: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/phases/phase-03__consolidar-esquema-options__PHASE__PROMPT.md

## Modo
refactor-safe + change-control

## Skills
telemetric-backend-style, telemetric-connectors-standard

## Objetivo
Consolidar un esquema unico de Options (reusar extensiones de conectores y validar defaults).

## Alcance (max 5 archivos de codigo)
- telemetric-hub/kiss/connectors/Telemetric.Connectors.Abstractions/Options/RedisOptions.cs
- telemetric-hub/kiss/connectors/Telemetric.Connectors.Abstractions/Options/RabbitOptions.cs
- telemetric-hub/kiss/connectors/Telemetric.Connectors.Abstractions/Options/ClickHouseOptions.cs

## Entregables
- contexto/02_changes/2026-02-05__phase-03__consolidar-esquema-options__plan.md (usar contexto/01_overview/templates/TEMPLATE_CHANGE_PLAN.md)
- contexto/02_changes/2026-02-05__phase-03__consolidar-esquema-options__summary.md (usar contexto/01_overview/templates/TEMPLATE_CHANGE_SUMMARY.md)

## Guardrails
- Max 5 archivos (solo los listados en Alcance)
- No ampliar alcance
- Prohibido cambiar contratos externos (Redis key patterns, Rabbit routing keys, SignalR group naming) sin migracion explicita
- Si algun path no existe: buscar y confirmar el path real antes de continuar

## No-go rules
- Requiere tocar archivos fuera del Alcance o superar 5 archivos
- Implica cambiar contratos externos sin migracion explicita
- No se puede cumplir la verificacion definida

## Verificacion (pasos manuales)
1. Accion: iniciar Hub/Workers/API con un unico set de parametros (Redis/Rabbit/ClickHouse) ya consolidado en Options. Expected: los tres procesos arrancan sin errores de configuracion.
2. Accion: API_CALL: <enviar frame serial.payload al Hub>. Expected: el Hub publica en Rabbit con exchange/routing esperado.
3. Accion: RABBIT_CHECK: <inspeccionar mensaje en exchange/queue de telemetry.data con routing correcto>. Expected: se observa mensaje con routing coherente.
4. Accion: CLICKHOUSE_SQL: <query de verificacion de insercion reciente>. Expected: existe al menos 1 registro nuevo asociado al frame enviado.
5. Accion: API_CALL: <consultar historico desde API>. Expected: el API devuelve el registro asociado al frame enviado.

## Done criteria
- El smoke test end-to-end pasa con routing correcto en Rabbit.
- ClickHouse registra el evento y el API lo puede leer.
- No se cambiaron contratos externos ni se toco fuera del Alcance.

## Tarea (ejecutor)
1. Ejecutar cambios minimos para cumplir el objetivo limitado al Alcance.
2. Completar plan + summary usando templates (con evidencia paths).
3. En summary: resultado observado vs expected para cada paso de verificacion + Done criteria.

## Post-step obligatorio
- Marcar [x] PHASE-03 en IndexRef
- Completar/actualizar links de Output (plan y summary) en el indice
- Actualizar contexto/03_hallazgos/pending.md solo si hay hallazgos nuevos o si el estado cambia
