# Builder Run - 2026-02-05T143812

## Input
Usar PackDir existente: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/
Fuente obligatoria: contexto/01_audits/2026-02-05__audit-03__hardening-minimo-cors-jwt-ef-authorization-duplicada.md
Quiero generar el PROMPT FINAL para ejecutar PHASE-01 basada en la seccion "Plan sugerido por fases", Fase 1.
Usa exactamente el objetivo/archivos/verificacion definidos ahi, sin ampliar alcance.

## Clasificacion
PHASE

## Rationale
- Se solicita ejecutar una fase concreta del plan, con objetivo, archivos y verificacion definidos.
- Implica cambios acotados en codigo (<=5 archivos), no una auditoria ni registro de hallazgo.

## PROMPT FINAL
# PHASE PROMPT
PackDir: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global
ItemId: PHASE-01
IndexRef: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/INDEX.md
PromptPath: contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/phases/phase-01__quitar-allowanonymous-organizations__PHASE__PROMPT.md

## Modo
refactor-safe + change-control

## Skills
- telemetric-backend-style

## Objetivo
Quitar AllowAnonymous() en Organizations para requerir autenticacion/autorizacion.

## Alcance (max 5 archivos de codigo)
- telemetric-api/src/Telemetric.Api/Features/Organizations/CreateOrganization/CreateOrganizationEndpoint.cs
- telemetric-api/src/Telemetric.Api/Features/Organizations/GetOrganizationById/GetOrganizationByIdEndpoint.cs
- telemetric-api/src/Telemetric.Api/Features/Organizations/UpdateOrganization/UpdateOrganizationEndpoint.cs
- telemetric-api/src/Telemetric.Api/Features/Organizations/DeleteOrganization/DeleteOrganizationEndpoint.cs

## Entregables
- contexto/02_changes/2026-02-05__phase-01__quitar-allowanonymous-organizations__plan.md (usar contexto/01_overview/templates/TEMPLATE_CHANGE_PLAN.md)
- contexto/02_changes/2026-02-05__phase-01__quitar-allowanonymous-organizations__summary.md (usar contexto/01_overview/templates/TEMPLATE_CHANGE_SUMMARY.md)
- actualizar contexto/03_hallazgos/pending.md solo si hay hallazgos nuevos o cambia el estado

## Guardrails
- Max 5 archivos de codigo: solo los listados en Alcance
- No ampliar alcance
- Prohibido cambiar contratos externos (Redis key patterns, Rabbit routing keys, SignalR group naming) sin migracion explicita
- Si algun path no existe: buscar y confirmar el path real antes de continuar

## No-go rules
- Si requiere tocar archivos fuera del Alcance o superar 5 archivos
- Si implica cambiar contratos externos sin migracion explicita
- Si no se puede cumplir la verificacion

## Verificacion (pasos manuales)
1. Accion: API_CALL: POST /organizations (sin Authorization) y GET /organizations/{id} (sin Authorization). Expected: 401 o 403 en ambos.
2. Accion: API_CALL: PUT /organizations/{id} y DELETE /organizations/{id} sin token. Expected: 401 o 403 en ambos.
3. Accion: API_CALL: POST/GET/PUT/DELETE con token valido y permisos adecuados. Expected: 200/OK o 204 segun endpoint.

## Done criteria
- Todos los endpoints de Organizations rechazan requests sin token con 401/403
- Los endpoints de Organizations responden OK con token valido y permisos adecuados
- Summary documenta resultado observado vs expected para cada paso de verificacion

## Tarea (ejecutor)
1) Ejecutar cambios minimos para cumplir el objetivo limitado al Alcance
2) Completar plan y summary usando los templates indicados (con evidencia y paths)
3) En summary: resultado observado vs expected para cada paso de verificacion + Done criteria

## Post-step
- Marcar [x] PHASE-01 en contexto/00_prompts/2026-02-04__pack-audit-pack-inicial-global/INDEX.md
- Completar/actualizar links de Output (plan y summary) en el indice
